#!/usr/bin/env zsh
# -*- mode: sh;sh-indentation: 4;indent-tabs-mode: nil;sh-basic-offset: 4; -*-
#
# Copyright (c) 2023 Sebastian Gniazdowski
#

# Recognize and save info on run as `#!/usr/bin/env zsh` script
[[ $0 != xzmsg || -n $ZSH_SCRIPT ]]&&integer bescript=1

# Set options
builtin emulate -L zsh -o extendedglob -o noshortloops \
                        -o warncreateglobal -o typesetsilent

# Set $0 with a new trik - use of %x prompt expansion
0=${${(M)${0::=${(%):-%x}}:#/*}:-$PWD/$0}

#
# The proper code
#

local CONTENT_VARNAME=$1 CHKTPE=$2 sp="[[:space:]]##"
local -a content=("${(P@)CONTENT_VARNAME}") save

repeat 1 {noglob zsfilt CHECK_EMULATE_-O_SETOPT $content;}
((!$#reply))&&return RESULT_NO_OPTIONS

printf Â·%s\\n Setopt/emulate\ lines: $reply
# vim:ft=zsh:sw=4:sts=4:et # vim:ft=zsh:sw=4:sts=4:et# vim:ft=zsh:sw=4:sts=4:et